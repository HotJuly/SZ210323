# VueRouter原理分析

1. VueRouter的了解
   1. 他是Vue的一个插件库
   2. 实现SPA应用(单页面应用)
      1. 单页面->单个html
      2. 其实只是用Vue也可以实现单页面应用,通过一些原生DOM的CRUD方法,对一个html进行添加删除节点,实现内容的变化
2. VueRouter提供给我们的内容
   1. 构造函数
      1. VueRouter
      2. 可以通过该构造函数,创建得到VueRouter的实例对象,俗称路由器对象router
   2. 组件
      1. router-view
         1. 该组件用于显示当前路径对应的路由组件
      2. router-link
         1. **该组件默认可以生成a标签,点击该a标签,最终可以实现路由地址的跳转,并且不会刷新当前页面**
   3. 核心对象
      1. $router(这是一个路由器对象,他会提供一些可以操作当前历史记录栈的方法)
         1. push
            1. 提供js的API,供开发者使用,使得开发者可以通过js代码对页面进行跳转
            2. 内部实际上封装了window.history.pushState方法,来控制页面的历史记录栈
         2. replace
         3. go
         4. back
      2. $route(这是一个路由独享,他会提供一些与当前路由相关的信息)
         1. query参数
         2. params参数
         3. meta参数
3. 我们需要提供给VueRouter的内容
   1. 配置对象(该配置对象必传参数)
      1. mode
         1. 数据类型:String
         2. 声明指定当前项目VueRouter的运行模式
            1. hash模式
               1. 优点:兼容性好
               2. 缺点:
                  1. 路径中带有#,太丑了
                  2. 锚点功能失效
               3. 原理:
                  1. 开发者可以通过window.location.hash="路由地址",控制浏览器的历史记录栈
                  2. 通过监视window的hashchange事件,可以得知路由地址的变化
            2. history模式
               1. 优点:
                  1. 路由中没有#,好看
                  2. 锚点功能有效
               2. 缺点:
                  1. 兼容性差,由于当前模式基于H5新特性history实现
                  2. **如果用户在某个路由路径下,刷新当前页面,会导致页面展示内容404**
                     1. 解决方法:
                        1. 让后端人员配置路由接口的时候,将他没有的路由都返回我们的html文件
                     2. 问题流程:
                        1. 假设用户正在/home路径下,刷新当前页面会重新请求服务器
                        2. 服务器接收到/home的请求,由于服务器没有该路由路径,最终返回404页面
                     3. 正确流程:
                        1. 假设用户正在/home路径下,刷新当前页面会重新请求服务器
                        2. 服务器接收到/home请求,虽然服务器没有该路由,但是也会返回html文件
                        3. 浏览器接收到html文件,开始解析,并请求index.js文件
                        4. 之后js文件中的VueRouter生效,开始解析地址栏中的路由地址
                        5. 并成功展示对应路由组件
               3. 原理:
                  1. 开发者可以通过window.history.pushState({},'',"路由地址"),控制浏览器的历史记录栈
                  2. 通过监视window的popstate事件,可以得知路由地址的变化
                     1. 注意:该事件只能监视用户通过浏览器前进后退按钮的操作,无法监视pushState方法的跳转操作
      2. routes
         1. 数据类型:routeObj[]
         2. 该数组内部每个对象都必须要有的属性
            1. path
               1. path是声明当前路由对应的路由路径
            2. component
               1. 如果当前浏览器地址栏中的地址与某个对象的path相同,就会显示对应的component