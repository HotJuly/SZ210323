# 跨域相关

1. 问题一:什么是跨域
   1. 跨域就是违反了浏览器制定的同源策略
   2. 同源策略:如果两个 URL 的 protocol(协议)、port (端口号) (如果有指定的话)和 host(域名或者ip地址) 都相同的话，则这两个 URL 是同源
      1. 总结:当前所展示的html文件的来源服务器地址,如果与请求数据资源的协议/host/port三者都相同,说明当前情况称为同源
   3. 为什么要检测是否跨域?
      1. 为了保障信息安全
         1. 防止当前网页读取用户本地文件(此处协议名不同,会报错)
         2. 防止当前网页私下请求其他网站,趁机获取用户数据(域名不同,会报错)
2. 问题二:跨域一定会报错吗
   1. 不一定
   2. 服务器之间不存在跨域问题
   3. 网页中的link,script,img,video,audio等标签,跨域访问资源都不会出现跨域问题
3. 问题三:什么情况下会出现跨域问题
   1. **跨域问题仅存于浏览器**
   2. **发送ajax请求的时候,如果跨域了,就会提示跨域问题**
   3. 总结:跨域问题应该是浏览器搞的鬼
4. 问题四:哪些请求算是ajax请求(async javascript and xml)
   1. 在地址栏中直接回车请求,不是ajax请求,是HTTP请求
   2. link,img,script等标签不属于ajax请求,他们也是HTTP请求
   3. 总结:
      1. **ajax只是浏览器上发送HTTP请求的技术,是通过js代码发送HTTP请求**
      2. 对于接收请求的服务器来说,ajax请求和HTTP请求没有区别,都是HTTP请求
5. 跨域解决方案
   1. jsonp
      1. 原理:script标签发送的请求不是ajax请求,所以不会报跨域问题
      2. 流程:
         1. 在前端网页创建一个专门用于接收数据的函数
         2. 当用户点击按钮,需要发送请求的时候,创建script标签,并将标签插入到页面上
         3. 通过script标签的src属性请求服务器接口,同时将函数名称传递给服务器
         4. 服务器将函数名称配合需要返回的数据,拼接成字符串返回给前端
   2. CORS(跨域资源共享)
      1. 原理:由于请求会发送给服务器,响应的时候由于跨域现象,所以会被浏览器拦截,服务器可以提前告知浏览器,允许当前网页跨域请求本服务器
      2. 流程:
         1. 后端人员需要对响应头进行配置修改,需要添加部分属性
            1. Access-Control-Allow-Origin:"http://localhost:3000"
   3. proxy
   4. nginx
6. 多标签页数据传递
   1. 根据跨域原理实现数据传递
      1. 通过window.open方法打开新的网页(该网页必须是同一家的网页,必须具有共同的顶级域名)
      2. 通过open方法,可以得到对应网页的window对象
      3. 将两个网页都配置document.domain="baidu.com(共同的顶级域名)"
      4. 最后可以通过2中获取的window属性,进行数据交互

