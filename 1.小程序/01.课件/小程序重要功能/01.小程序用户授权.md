# 小程序用户授权

1. 到2021/8/14为止,一共出现了三种获取用户授权方法,目前可用一种
2. 用户首次登陆授权:
   1. 早期
      1. 直接调用wx.getUserInfo({}),可以弹出授权窗口,实现用户授权(目前已经废弃,因为非常影响用户体验,所以才换成中期版本)
   2. 中期(21/4月,该方法废弃,正式出现第三种)
      1. 通过button组件获取用户个人信息,需要配置标签属性open-type="getUserInfo"
      2. 用户选择之后(无论用户选择取消还是确定,都会执行success回调),获取到用户的个人信息,需要绑定事件,事件名getuserinfo
      3. 在事件回调函数中,通过形参res.detail可以获取到用户个人信息
      4. 将获取到的个人信息更新到data中,在wxml中展示即可
      5. 注意:data的属性可以不需要提前声明,可以后续通过setData新增
   3. 最新
      1. API:wx.getUserProfile()
      2. 注意:
         1. 问题一: 报错信息"wx.getUserProfile is not a function"
            1. 说明:当前版本库不支持该API,需要调整版本库(版本必须是2.15.0以上)
         2. 可以通过wx.canIUse检查当前API是否适用
         3. 每次调用该API都会弹出授权窗口
         4. 该API必须在点击事件的回调函数中执行才有用,否则无效(例如onLoad)
         5. 如果还想实现二次登录免授权功能,可以在首次获取到信息之后,将信息缓存到本地存储中(Storage)中
3. 用户二次登录免授权(**静默登录**):
   1. API:wx.getUserInfo({})
   2. 通过该API可以获取到用户的个人信息
   3. 注意点:该API只能在用户经过了首次登录授权流程之后,才能够直接获取到用户个人信息
4. 奇特的组件
   1. 组件名:open-data
   2. 该组件很鸡肋,仅用于给用户观看,开发者想要获取到内部数据,无法获取
